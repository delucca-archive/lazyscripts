#if 0
	shc Version 3.9.6, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -f src/commands/bootstrap-codespaces/bootstrap-codespaces.sh -o bin/bootstrap-codespaces 
#endif

static  char data [] = 
#define      tst1_z	22
#define      tst1	((&data[0]))
	"\252\356\140\155\020\243\063\127\316\216\346\330\163\311\002\102"
	"\340\070\200\161\222\332"
#define      msg1_z	65
#define      msg1	((&data[22]))
	"\263\007\345\360\144\041\344\213\132\243\253\177\373\260\050\162"
	"\161\301\226\364\266\012\110\225\370\334\167\076\361\042\100\173"
	"\033\123\335\057\343\047\243\371\271\034\016\275\031\351\346\350"
	"\036\343\244\263\355\026\261\010\074\316\125\144\306\216\161\103"
	"\107\021\005\253\261\160\332\106\354\244\101\102\165"
#define      text_z	3152
#define      text	((&data[245]))
	"\140\170\176\173\013\241\212\251\152\203\044\206\220\075\225\107"
	"\116\232\362\377\013\314\106\367\161\207\072\346\127\151\351\270"
	"\341\150\064\355\012\276\227\165\102\273\373\322\370\220\031\107"
	"\052\014\107\066\330\215\055\111\025\147\057\155\321\031\046\263"
	"\202\132\240\215\031\067\002\133\363\376\056\354\217\110\063\272"
	"\124\172\360\054\010\036\166\036\206\246\213\127\300\261\012\102"
	"\013\253\320\045\343\323\200\326\321\257\302\141\367\366\034\114"
	"\161\014\171\172\052\357\230\261\226\043\010\126\324\023\231\340"
	"\277\151\005\242\074\206\171\016\065\074\157\055\062\213\172\243"
	"\230\363\342\073\073\010\362\240\070\277\130\303\260\370\366\052"
	"\365\356\254\242\207\274\063\256\260\114\265\263\213\145\344\264"
	"\050\152\221\062\061\321\333\066\174\344\101\345\013\252\335\070"
	"\370\176\356\310\152\317\040\334\270\226\204\370\017\127\104\302"
	"\161\252\374\107\354\307\362\157\247\240\155\074\127\000\206\116"
	"\327\145\226\333\043\123\205\145\274\212\342\363\305\276\273\212"
	"\175\057\336\312\261\005\235\010\160\343\356\324\156\134\061\016"
	"\352\350\327\262\141\012\135\036\211\360\022\277\274\041\055\042"
	"\314\371\126\211\324\044\347\134\005\065\041\112\276\031\332\327"
	"\362\143\216\101\220\200\036\251\032\077\330\304\013\222\222\355"
	"\260\230\256\076\310\310\112\362\341\233\173\226\122\136\042\130"
	"\355\222\336\244\036\201\354\200\337\023\012\102\067\250\026\355"
	"\361\233\315\375\376\117\152\030\172\024\302\326\105\266\042\031"
	"\224\261\364\345\072\152\234\361\003\161\110\206\025\255\263\075"
	"\072\236\051\214\220\240\335\220\323\122\174\244\000\323\167\244"
	"\345\125\313\315\347\041\370\235\077\342\006\260\005\251\242\106"
	"\302\362\344\205\355\313\105\217\021\374\224\362\204\302\173\205"
	"\271\064\120\003\202\053\014\054\226\166\124\325\114\123\007\053"
	"\020\214\164\353\245\112\251\225\325\130\264\031\173\274\271\040"
	"\011\361\104\051\265\336\203\031\214\125\122\076\124\332\251\202"
	"\070\061\305\052\204\163\346\171\171\035\236\110\213\362\375\326"
	"\334\126\024\156\134\027\164\117\214\262\110\257\241\171\315\212"
	"\110\041\074\107\256\102\111\244\012\136\311\364\034\011\020\250"
	"\243\214\203\366\365\147\073\076\164\242\060\136\173\116\346\216"
	"\171\022\216\017\311\117\127\306\050\052\024\360\206\247\207\114"
	"\274\276\051\044\240\315\375\350\140\146\073\032\140\355\240\237"
	"\131\320\233\213\224\211\346\227\307\112\173\032\210\331\167\276"
	"\002\242\140\254\013\264\241\222\017\076\213\336\120\212\145\005"
	"\316\144\055\156\034\062\344\256\045\264\375\374\336\113\120\031"
	"\203\266\037\061\326\325\321\203\040\013\132\176\321\032\121\351"
	"\164\270\160\142\017\132\043\112\314\220\003\337\342\057\375\150"
	"\213\356\000\340\363\353\314\200\333\210\051\222\145\152\140\262"
	"\164\345\113\254\365\357\042\113\171\014\275\225\353\234\342\350"
	"\077\126\172\224\163\164\014\066\222\045\344\054\366\061\326\041"
	"\115\305\027\300\254\141\371\134\126\373\137\304\050\054\146\302"
	"\276\142\030\103\247\023\231\342\333\025\141\141\367\050\162\171"
	"\364\164\215\062\130\136\106\077\223\324\215\312\232\147\345\221"
	"\120\263\071\146\055\310\364\361\133\224\204\242\116\026\367\154"
	"\076\376\350\341\254\004\225\104\172\013\043\132\015\065\357\241"
	"\151\043\361\166\361\003\210\350\001\247\121\253\275\123\077\046"
	"\032\336\263\377\065\314\153\316\055\024\320\132\043\216\142\130"
	"\151\224\000\375\162\124\014\246\262\354\061\025\121\266\174\152"
	"\000\000\153\255\341\077\157\056\302\021\162\221\241\151\072\015"
	"\256\016\373\264\066\337\001\064\217\323\263\122\342\220\364\302"
	"\216\137\112\375\227\071\264\106\350\040\355\316\044\114\207\060"
	"\007\046\062\107\175\376\147\306\306\277\354\220\260\130\242\323"
	"\002\036\064\157\065\217\321\304\001\032\115\315\220\041\164\140"
	"\272\070\364\165\035\370\032\107\332\367\342\025\064\273\133\067"
	"\033\261\016\045\174\307\154\107\177\101\377\314\377\156\037\154"
	"\173\057\300\026\042\154\120\105\337\140\220\332\150\343\112\225"
	"\352\070\004\252\320\024\220\321\164\302\221\366\151\121\310\105"
	"\212\265\031\146\356\160\343\302\166\314\215\044\224\362\111\210"
	"\363\124\031\217\277\111\067\053\075\067\170\146\311\251\013\042"
	"\177\306\363\027\234\162\347\330\243\204\274\235\122\013\114\044"
	"\137\377\011\016\364\025\233\121\073\005\026\225\122\326\332\073"
	"\120\152\373\301\277\030\202\341\010\376\156\363\374\344\364\344"
	"\114\257\246\271\353\360\334\306\143\111\077\043\037\122\051\224"
	"\302\035\267\227\015\225\055\330\033\146\026\245\361\061\120\272"
	"\014\073\024\261\337\242\224\010\337\007\333\252\027\065\254\315"
	"\233\214\112\375\276\136\261\200\143\043\215\376\123\165\351\267"
	"\244\022\173\225\341\236\303\311\202\143\351\316\104\040\150\115"
	"\026\140\276\340\352\112\213\063\335\200\231\204\231\074\074\065"
	"\063\110\047\167\062\263\217\232\052\040\361\277\040\143\304\262"
	"\337\231\152\341\304\216\326\157\121\105\343\337\031\042\265\237"
	"\067\053\146\014\224\014\232\262\135\147\247\071\175\133\352\051"
	"\166\107\271\255\341\034\362\363\000\252\277\210\025\064\257\021"
	"\007\322\243\315\212\217\002\221\115\366\017\002\325\066\000\173"
	"\251\222\163\262\375\127\356\246\214\024\322\106\046\163\155\136"
	"\253\202\103\365\144\100\174\062\340\224\022\363\370\376\360\011"
	"\132\073\067\326\362\217\112\075\333\170\140\017\267\003\327\253"
	"\160\110\376\371\024\073\247\235\046\065\300\027\261\050\324\302"
	"\163\041\267\263\312\000\234\250\317\202\262\252\103\250\165\044"
	"\057\344\342\016\022\054\274\264\123\131\316\025\110\327\337\325"
	"\277\321\263\032\234\165\305\216\202\345\366\365\365\062\375\266"
	"\370\025\035\015\366\264\176\354\266\161\174\276\010\362\215\147"
	"\256\304\336\051\065\266\024\176\120\224\015\136\104\235\065\033"
	"\235\276\277\164\345\364\176\027\252\362\035\353\224\221\315\020"
	"\010\145\041\202\006\326\156\325\004\361\220\141\027\010\303\036"
	"\336\167\077\050\214\117\370\054\331\163\226\264\220\113\076\324"
	"\330\227\156\114\245\162\214\222\313\114\217\303\237\133\063\143"
	"\025\256\352\062\354\157\217\232\135\352\157\122\010\204\136\321"
	"\103\373\146\142\204\063\314\201\333\143\134\034\257\224\236\071"
	"\067\052\042\114\135\204\303\262\160\372\326\346\006\027\040\150"
	"\175\014\342\227\350\207\031\361\261\364\353\072\305\162\126\175"
	"\117\260\114\004\004\351\243\135\045\033\051\343\131\222\306\310"
	"\212\021\055\364\256\331\147\330\324\076\172\023\077\273\347\364"
	"\015\000\233\053\164\101\110\224\363\231\370\042\064\177\046\342"
	"\352\350\251\007\124\124\334\142\241\253\322\017\004\062\164\366"
	"\352\243\134\244\366\040\224\274\145\271\025\050\215\250\260\044"
	"\304\122\174\235\115\350\324\245\377\177\123\057\313\121\244\137"
	"\147\236\324\350\344\364\376\037\016\022\251\121\003\007\261\172"
	"\003\173\221\256\253\247\206\340\251\025\277\177\264\344\021\112"
	"\360\364\166\261\331\140\025\320\347\236\241\364\316\325\355\113"
	"\246\021\342\146\033\214\222\273\115\005\023\040\075\125\350\315"
	"\336\330\005\031\043\141\173\205\040\246\006\105\043\171\047\310"
	"\240\244\227\352\045\314\057\073\021\342\111\135\334\073\203\122"
	"\143\313\252\303\151\342\152\125\120\006\317\155\172\137\350\200"
	"\021\304\264\012\006\205\332\174\300\142\150\052\074\261\275\150"
	"\316\120\047\176\244\021\003\145\230\213\031\160\167\064\305\231"
	"\116\265\161\156\231\333\355\054\135\377\131\227\233\135\235\017"
	"\237\336\136\313\304\071\071\310\215\156\100\333\136\113\252\077"
	"\002\337\277\266\002\244\252\212\213\073\223\171\203\316\103\265"
	"\204\150\264\143\102\323\360\047\303\201\215\250\373\161\016\216"
	"\273\106\324\034\022\351\322\177\022\165\064\317\262\257\175\262"
	"\223\324\157\142\170\161\233\103\301\277\113\164\051\141\102\040"
	"\270\054\143\046\355\363\121\042\363\332\037\263\116\003\213\023"
	"\140\356\105\327\336\147\031\376\030\031\005\065\265\141\076\072"
	"\253\212\047\316\151\273\346\263\277\005\043\131\110\033\357\124"
	"\126\114\075\043\110\201\257\002\157\320\263\231\136\130\016\206"
	"\333\327\103\112\026\344\247\130\134\332\006\272\310\054\035\315"
	"\154\366\306\205\314\111\113\370\137\010\344\240\277\014\236\152"
	"\021\167\254\112\212\341\251\065\055\003\267\312\313\225\004\252"
	"\104\120\001\031\166\333\015\364\204\264\327\040\202\112\157\246"
	"\043\361\115\357\105\034\176\376\302\203\247\271\175\065\063\320"
	"\145\260\314\023\325\344\115\060\132\052\320\365\047\360\041\141"
	"\016\310\262\155\143\324\236\321\343\253\240\235\162\117\306\336"
	"\226\156\260\100\364\356\243\217\356\124\237\253\260\234\261\306"
	"\227\342\331\264\170\053\057\045\236\126\345\075\232\140\010\031"
	"\046\153\275\317\075\054\171\321\065\354\027\231\177\177\333\104"
	"\243\324\225\241\116\343\302\267\267\261\261\000\223\170\341\134"
	"\057\006\136\060\217\140\301\010\342\031\333\254\341\235\237\137"
	"\307\147\165\040\005\130\035\270\316\045\250\044\301\247\112\025"
	"\330\132\032\233\137\104\121\032\024\037\203\037\146\131\234\315"
	"\006\003\030\103\362\012\154\142\037\206\142\353\255\131\034\060"
	"\072\311\375\253\062\322\074\214\046\113\136\143\244\337\124\143"
	"\127\061\174\307\107\011\116\266\231\261\164\235\104\103\363\044"
	"\040\257\160\351\377\364\322\057\211\165\107\060\355\060\224\063"
	"\177\010\120\325\311\333\062\143\362\247\026\031\234\027\112\145"
	"\271\035\165\246\105\077\073\314\034\370\210\066\250\317\051\260"
	"\024\065\242\016\356\046\362\313\132\303\236\040\372\043\222\040"
	"\030\250\072\121\142\305\244\054\140\361\220\223\362\002\212\236"
	"\153\016\353\316\243\001\026\114\234\241\150\325\355\170\057\371"
	"\356\274\335\347\231\061\150\227\032\320\153\257\102\125\043\357"
	"\125\113\171\343\260\012\055\006\263\331\254\255\076\060\312\010"
	"\224\352\370\311\370\022\100\003\042\170\247\044\073\105\300\320"
	"\331\115\321\371\333\205\042\336\227\012\271\255\136\011\311\165"
	"\067\231\141\132\207\345\067\112\256\056\115\331\033\053\340\163"
	"\075\255\216\205\314\053\006\041\355\014\013\325\270\051\225\161"
	"\072\241\331\351\345\331\357\210\064\067\342\044\300\207\231\033"
	"\246\111\221\245\017\024\342\063\102\024\326\225\165\123\344\135"
	"\013\347\173\273\306\317\134\210\346\055\224\335\240\000\227\127"
	"\252\031\376\142\026\114\155\356\361\205\111\256\341\227\353\260"
	"\160\373\266\043\235\042\246\300\315\033\032\300\322\340\104\065"
	"\033\112\001\057\317\156\022\061\277\014\173\136\240\352\341\221"
	"\062\226\040\227\347\355\255\325\010\030\177\051\147\045\054\044"
	"\143\303\252\144\204\112\265\123\236\346\244\123\247\031\204\161"
	"\136\251\247\163\163\301\020\033\123\125\253\322\257\336\301\073"
	"\230\353\332\363\014\352\322\376\335\223\253\305\364\146\265\203"
	"\012\103\342\040\067\236\270\267\136\321\241\202\146\234\110\162"
	"\174\171\203\043\323\231\376\163\334\346\344\127\001\031\021\033"
	"\001\077\303\103\163\004\353\264\274\337\157\047\023\143\035\250"
	"\374\123\304\110\247\164\334\245\117\242\360\006\365\316\112\002"
	"\266\122\111\172\164\141\352\047\321\024\250\270\132\300\151\073"
	"\014\047\041\030\107\277\062\034\356\047\126\024\124\334\107\103"
	"\010\255\267\113\153\256\315\324\211\171\374\352\274\130\347\260"
	"\344\052\244\133\300\037\076\046\212\237\375\050\303\331\161\134"
	"\161\130\124\202\351\376\004\373\344\000\216\304\241\231\016\072"
	"\165\251\252\230\116\036\166\230\166\316\100\161\300\144\162\062"
	"\253\122\310\302\254\147\227\054\314\302\132\313\332\374\017\066"
	"\013\340\342\014\335\135\362\025\064\271\233\016\333\134\277\050"
	"\066\042\257\332\056\013\013\231\037\103\173\277\252\264\025\101"
	"\022\150\156\316\351\362\307\131\302\111\222\010\211\361\103\132"
	"\130\162\072\164\317\156\152\230\235\230\110\366\274\043\035\243"
	"\310\135\031\211\170\370\152\103\155\205\167\107\350\170\106\117"
	"\212\307\167\144\274\372\057\013\313\203\204\377\157\341\363\047"
	"\061\173\317\341\036\333\250\106\102\045\164\132\200\340\010\375"
	"\355\075\045\374\307\024\272\267\253\277\250\036\326\306\067\361"
	"\042\343\367\044\030\070\343\216\363\127\051\167\014\050\303\210"
	"\047\203\056\230\072\347\150\255\044\054\071\270\134\177\143\102"
	"\233\240\133\076\200\051\104\224\340\362\101\376\276\221\045\005"
	"\176\013\203\206\244\270\021\143\021\076\120\251\051\365\377\041"
	"\241\203\215\246\113\300\062\330\124\101\166\121\177\234\156\276"
	"\252\100\162\275\115\262\113\173\241\301\351\115\272\246\127\256"
	"\231\117\212\212\001\021\220\204\275\111\207\046\236\110\270\160"
	"\012\110\227\216\014\267\310\116\347\002\274\170\033\235\305\156"
	"\316\370\202\010\317\272\262\140\353\343\246\152\362\170\150\114"
	"\376\354\150\114\007\261\235\331\245\310\166\024\254\311\373\357"
	"\314\063\113\235\056\207\232\142\032\357\156\223\300\125\356\237"
	"\366\224\330\001\343\303\205\111\131\231\042\041\044\110\361\110"
	"\211\315\226\177\204\175\213\356\357\025\041\321\024\127\352\101"
	"\163\125\344\020\262\057\372\326\157\122\070\305\142\144\307\360"
	"\254\351\345\227\373\161\041\301\143\305\324\264\061\153\373\146"
	"\216\272\373\201\261\143\261\014\202\163\101\300\124\071\375\343"
	"\063\314\041\320\376\025\356\231\141\222\212\064\035\225\267\110"
	"\313\141\067\145\326\140\234\104\306\201\110\062\034\022\111\247"
	"\276\003\160\335\040\145\056\370\336\221\204\037\302\162\110\141"
	"\331\331\262\006\306\223\002\270\136\217\335\034\014\351\306\331"
	"\036\314\217\115\357\003\026\375\130\057\235\011\112\004\136\105"
	"\075\334\232\323\022\164\375\053\161\046\210\275\344\236\041\351"
	"\003\210\154\175\267\154\073\141\122\345\024\311\215\125\255\060"
	"\366\240\224\350\176\223\172\034\305\170\273\344\052\255\255\040"
	"\070\210\044\256\300\256\223\322\343\135\216\362\311\146\045\072"
	"\201\201\124\244\127\242\262\256\100\215\365\245\336\017\204\177"
	"\160\271\023\012\067\343\276\105\140\362\111\044\350\063\335\026"
	"\116\137\316\320\377\167\173\303\264\223\330\155\150\313\017\301"
	"\363\261\375\234\327\276\232\365\355\270\241\212\257\063\211\304"
	"\002\146\250\320\142\231\221\001\311\111\050\374\224\322\101\127"
	"\051\373\035\303\343\265\164\171\331\174\317\256"
#define      chk1_z	22
#define      chk1	((&data[3409]))
	"\117\322\322\172\035\155\371\217\164\264\146\354\316\150\142\104"
	"\240\253\370\371\155\130\273\306\224\362\016"
#define      date_z	1
#define      date	((&data[3434]))
	"\145"
#define      inlo_z	3
#define      inlo	((&data[3435]))
	"\177\240\374"
#define      msg2_z	19
#define      msg2	((&data[3442]))
	"\371\175\261\354\231\015\312\071\230\134\334\325\242\242\055\215"
	"\126\072\243\365\015\314\170"
#define      rlax_z	1
#define      rlax	((&data[3461]))
	"\154"
#define      xecc_z	15
#define      xecc	((&data[3465]))
	"\052\145\031\270\177\106\377\024\012\373\314\023\060\104\351\175"
	"\273\047\330"
#define      chk2_z	19
#define      chk2	((&data[3483]))
	"\106\124\337\167\047\270\145\361\264\010\173\332\242\173\062\042"
	"\114\031\216\006\241\374\070"
#define      lsto_z	1
#define      lsto	((&data[3504]))
	"\120"
#define      opts_z	1
#define      opts	((&data[3505]))
	"\203"
#define      pswd_z	256
#define      pswd	((&data[3564]))
	"\046\340\243\327\315\076\113\235\220\064\347\272\232\001\223\221"
	"\203\372\327\327\367\017\073\016\263\273\167\377\310\137\045\356"
	"\100\310\305\015\007\021\253\227\106\223\121\341\224\345\162\027"
	"\340\112\357\327\132\052\346\016\345\135\302\022\134\354\054\176"
	"\333\102\005\242\256\065\310\200\072\007\056\017\014\302\254\303"
	"\304\327\217\332\335\102\045\346\317\350\370\054\324\044\253\260"
	"\147\260\123\025\345\033\225\040\043\304\057\060\207\334\363\113"
	"\263\203\045\220\306\113\166\225\063\156\302\010\223\155\271\372"
	"\035\015\017\003\050\245\043\114\152\122\175\361\056\160\074\342"
	"\363\142\162\272\256\351\117\342\130\021\353\353\177\244\346\234"
	"\262\365\237\332\233\302\047\006\025\244\367\104\025\064\046\011"
	"\227\231\303\106\202\023\050\332\045\023\306\244\270\254\101\152"
	"\242\340\105\076\243\155\104\271\021\074\375\046\161\044\060\010"
	"\275\363\116\077\006\167\032\053\212\341\320\103\215\021\256\060"
	"\362\364\156\225\141\263\117\163\360\114\232\141\160\312\151\056"
	"\275\270\155\303\057\210\357\272\151\277\376\367\321\254\047\303"
	"\241\226\130\002\112\250\165\072\364\017\233\145\331\005\223\227"
	"\275\001\133\355\212\113\247\363\012\245\353\333\122\023\237\363"
	"\251\367\366\364\240\153\057\225\173\312\372\125\320\216\355\216"
	"\220\110\173\032\223\043\016\236\310\371\015\256\275\062\234\375"
	"\373\142\013"
#define      shll_z	10
#define      shll	((&data[3830]))
	"\231\135\206\314\207\110\200\213\200\246\154\273\111"
#define      tst2_z	19
#define      tst2	((&data[3845]))
	"\320\020\365\300\106\044\302\302\230\237\375\211\335\266\165\002"
	"\350\012\260\160\013\341\260\132\344\207"/* End of data[] */;
#define      hide_z	4096
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
#	define PTRACE_ATTACH	PT_ATTACH
#endif
void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PTRACE_ATTACH, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
